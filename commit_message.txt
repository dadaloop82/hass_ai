fix: correct usage of async_get_agent in agent check